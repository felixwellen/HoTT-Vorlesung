\subsection{Höhere Induktive Typen}

Höhere induktive Typen haben neben Konstruktoren der Bauart, die wir bereits von den Induktiven Typen kennen, sogenannte \begriff{höhere Konstruktoren},
deren Werte in Gleichheitstypen des höheren induktiven Typs liegen.
Später werden wir auch höhere induktive Typen mit höheren Konstruktoren, die in iterierten Gleichheitstypen liegen, sehen.
Zunächst wird der Typ $S¹$ zentral sein. Dieser hat wie der Typ $\eins$ einen Punkt-Konstruktor $\ast:S^1$ und zusätzlich einen
höheren Konstruktor $l:\ast =_{S^1}\ast$.

Eine Rekursionsregel ist leicht formuliert: Um eine Funktion $f:S^1\to A$ zu definieren, muss man $f(\ast):A$ und $f(l):f(\ast)=_A f(\ast)$ vorgeben.
Das Induktionsprinzip ist etwas unhandlicher und wir wollen zunächst ein paar Definition machen, die uns die Formulierung erleichtern und schließlich nach der Einführung der neuen Regeln
das Rekursionsprinzip aus dem Induktionsprinzip folgern.

In \cref{lem:gleichheit-summe} haben wir festgestellt, dass ein Teil einer Gleichheit in einer abhängigen Summe von der Form
\begin{mathpar}
  \transp_B(p)(b)=b'
\end{mathpar}
ist. Das werden wir jetzt als allgemeine Definition von Gleichheiten in abhängigen Typen verwenden.
\begin{definition}[Abhängige Gleichheit]
  Seien $A:\mU$, und $B:A\to \mU$. Seien weiter $x,y:A$, $b:B(x)$ und $b':B(y)$.
  \begin{enumerate}
  \item Sei $p:x=_A y$. Ein \begriff{abhängier Pfad} oder eine \begriff{abhängige Gleichheit} zwischen $b$ und $b'$ ist ein Element des Typs
    \begin{mathpar}
      \left(b =_p^B b'\right)\colonequiv \left(\transp_B(p)(b)=b'\right)
    \end{mathpar}
  \item Sei $s:\prod_{x:A}B(x)$ eine abhängige Funktion. Die folgende Funktion ist die Anwendung eine abhängigen Funktion auf eine Gleichheit:
    \begin{mathpar}
      \mathrm{apd}(s):\prod_{p:x=_A y}s(x)=_p^B s(y)
    \end{mathpar}
    und festgelegt durch $\mathrm{apd}(s,\refl_x)\colonequiv\refl_b$. Wir schreiben auch $s(p)$ für $\mathrm{apd}(s,p)$.
  \end{enumerate}
\end{definition}

Damit können wir die folgenden Regeln für den induktiven Einheitskreis leichter formulieren.
Zunächst wollen wir noch die abhängige Variante mit der bekannten Anwendung von Funktionen auf Gleichheiten vergleichen:

\begin{bemerkung}
  \label{bem:transpconst}
  Seien $A,B:\mU$. Dann gilt:
  \begin{enumerate}
  \item Für $x,y:A$, $p:x=_A y$ und alle $b:B$ erhalten wir eine abhängige Gleichheit
    \begin{mathpar}
      \transpconst_{p,b}:\transp_{\_\mapsto B}(p)(b)=b
    \end{mathpar}
    durch Induktion über $p$ und $\transpconst_{\refl_x,b}\colonequiv \refl_b$.
  \item Für $f:A \to B$ und $p:x =_A y$ gilt $\mathrm{apd}(f,p)= \transpconst_{p,f(x)}\kon\mathrm{ap}(f,p)$.
  \end{enumerate}
\end{bemerkung}
\begin{beweis}
  \begin{enumerate}
  \item Bereits erledigt.
  \item Induktion über $p$.
  \end{enumerate}
\end{beweis}


Anders als bei den Konstruktoren induktiver Typen, werden wir bei höheren Konstruktoren keine urteilsmäßige Gleichheit für Berechnungen fordern,
sondern nur Gleichheit.

\begin{regeln}
  Es gibt einen Typ $S^1:\mU$ den wir den (höheren induktiven) \begriff{Kreis}\index{Kreis}\index{$S^1$} nennen.
  $S^1$ ist der höhere induktive Typ mit den Konstruktoren:
  \begin{align*}
    \ast:S^1 \\
    l:\ast =_{S^1}\ast
  \end{align*}
  Das heißt für jeden abhängigen Typ $B:S^1\to\mU$ reicht es $b:B(\ast)$ und $b_l:b =_l^B b$ vorzugeben,
  um eine abhängige Funktion $s:\prod_{x:S^1}B(x)$ zu definieren.
  Es gibt also eine Funktion:
  \begin{mathpar}
    \ind{S^1}:\prod_{B:S^1\to\mU}\prod_{b:B(\ast)}\left((b =_l^B b)\to\prod_{x:S^1}B(x)\right)
  \end{mathpar}
  die $\begriff{Kreisinduktion}$.
  Es gelten folgende Berechnungsregeln:
  \begin{align*}
    \ind{S^1}(B,b,b_l)(\ast)&\equiv b \\
    \mathrm{apd}(\ind{S^1}(B,b,b_l),l)\equiv \ind{S^1}(B,b,b_l)(l)&=b_l
  \end{align*}
  Wir werden abhängige Funktionen $s:\prod_{x:S^1}B(x)$ auch durch Fallunterscheidung wie folgt angeben:
  \begin{align*}
    s(\ast)\colonequiv b \\
    s(l):= b_l
  \end{align*}
\end{regeln}

\begin{bemerkung}
  Wie bereits bei den induktiven Typen, werden wir auch hier darauf verzichten, ein allgemeines Schema anzugeben.
  Unter Homotopietypentheorie versteht man eine Typentheorie wie soweit eingeführt, in der jeder sinnvolle höhere induktive Typ existiert.
  Wir werden lediglich Beispiele von sinnvollen höheren induktiven Typen kennenlernen.
\end{bemerkung}

Wir wollen zunächst das Rekursionprinzip für den Kreis herleiten.

\begin{bemerkung}
  Für $A:\mU$, $a:A$ und $a_l:a=_A a$ gibt es stets eine Funktion $\rec{S^1}(A,a,a_l):S^1\to A$ mit
  \begin{align*}
    \rec{S^1}(A,a,a_l)(\ast)\equiv a \\
    \rec{S^1}(A,a,a_l)(l)=a_l
  \end{align*}
\end{bemerkung}
\begin{beweis}
  Wir verwenden Kreisinduktion für den konstanten abhängigen Typ $\_\mapsto A:S^1\to\mU$.
  Es gibt eine Äquivalenz
  \begin{mathpar}
    (a =_l a) \simeq (a =_A a)
  \end{mathpar}
  durch Linkskonkatenation mit $\transpconst_{l,a}^{-1}$.
  Wir verwenden die Inverse, um aus $a_l:a=_A a$ die Gleichheit $\transpconst_{l,a}\kon a_l:a=_l a$ zu produzieren.
  Damit gilt für
  \begin{mathpar}
    \rec{S^1}(A,a,a_l)\colonequiv \ind{S^1}(\_\mapsto A, a, \transpconst_{l,a}\kon a_l)
  \end{mathpar}
  nach \cref{bem:transpconst}:
  \begin{align*}
    \mathrm{ap}(\rec{S^1}(A,a,a_l),l)&\equiv \mathrm{ap}(\ind{S^1}(\_\mapsto A, a, \transpconst_{l,a}\kon a_l),l) \\
                                     &=\transpconst_{l,a}^{-1}\kon\mathrm{apd}(\ind{S^1}(\_\mapsto A, a, \transpconst_{l,a}\kon a_l),l) \\
                                     &=\transpconst_{l,a}^{-1}\kon\transpconst_{l,a}\kon a_l \\
                                     &=a_l
  \end{align*}
  Nach Definition gilt außerdem $\rec{S^1}(A,a,a_l)(\ast)\equiv a$.
\end{beweis}

Bevor wir den Kreis weiter kennenlernen, betrachten wir noch einen weiteren, sehr ähnlichen höheren induktiven Typ.

\begin{regeln}
  Es gibt einen Typ $I:\mU$, das \begriff{Intervall} mit den folgenden Konstruktoren:
  \begin{align*}
    0_I:I \\
    1_I:I \\
    s:0_I =_I 1_I
  \end{align*}
  Daraus ergibt sich das folgende Induktionsprinzip, die \begriff{Intervallinduktion}:
  \begin{mathpar}
    \ind{I}:\prod_{B:I\to\mU}\prod_{b_0:B(0_I)}\prod_{b_1:B(1_I)}b_0 =_s^B b_1 \to\prod_{x:I}B(x) 
  \end{mathpar}
  mit Berechnungsregeln:
  \begin{align*}
    \ind{I}(B,b_0,b_1,b_s)(0_I)\equiv b_0 \\
    \ind{I}(B,b_0,b_1,b_s)(1_I)\equiv b_1 \\
    \mathrm{apd}(\ind{I}(B,b_0,b_1,b_s),s)\equiv\ind{I}(B,b_0,b_1,b_s)(s) = b_s \\
  \end{align*}
\end{regeln}

\begin{bemerkung}
  Das Intervall $I$ ist kontrahierbar.
\end{bemerkung}
\begin{beweis}
  Als Kontraktionszentrum wählen wir $0_I$. Nun wollen wir zeigen:
  \begin{mathpar}
    \prod_{x:I}0_I=x
  \end{mathpar}
  Mit Intervallinduktion reicht es dafür festzustellen, dass $\refl:0_I=0_I$ und $s:0_i=1_I$ gelten und zu zeigen:
  \begin{mathpar}
    \refl =_s s
  \end{mathpar}
  oder anders formuliert: $\transp_{0_I=\_}(s)(\refl)=s$. Das haben wir aber bereits allgemein geklärt in \cref{lem:transp-lpath}.
\end{beweis}

Trotzdem können wir mit dem Intervall etwas neues zeigen.
Davor brauchen wir noch das Rekursionsprinzip.
\begin{lemma}[Intervallrekursion und ihre Eindeutigkeit]
  Sei $A:\mU$.
  \begin{enumerate}
  \item Für $a,a':A$ und $a_s:a=_A a'$ gibt es
    \begin{mathpar}
      \rec{I}(A,a,a',a_s):I\to A
    \end{mathpar}
    mit $\rec{I}(A,a,a',a_s)(0_I)\equiv a$, $\rec{I}(A,a,a',a_s)(1_I)\equiv a'$ und $\rec{I}(A,a,a',a_s)(s) = a_s$.
  \item Für $f:I\to A$ gilt:
    \begin{mathpar}
      f=\rec{I}(A,f(0_I),f(1_I),f(s))
    \end{mathpar}
  \end{enumerate}
\end{lemma}
\begin{beweis}
  \begin{enumerate}
  \item Wie bei der Kreisrekursion.
  \item Noch nicht entschieden, ob das eine Übungsaufgabe ist.
  \end{enumerate}
\end{beweis}

Zunächst erweitern wir die Definition von Homotopien auf abhängige Typen:
\begin{definition}
  Seien $A:\mU$, $B:A\to \mU$ und $f,g:\prod_{x:A}B(x)$. Eine \begriff{abhängige Homotopie}\index{$\sim$} von $f$ nach $g$ ist ein Term von
  \begin{mathpar}
    f\sim g\colonequiv \prod_{x:A}f(x)=g(x)
  \end{mathpar}
  Weiter verwenden wir in diesem Abschnitt die Funktion
  \begin{mathpar}
    \mathrm{hap}\colonequiv (p:f=g)\mapsto (x:A)\mapsto\mathrm{ap}(f\mapsto f(x),p) :f=g\to f\sim g
  \end{mathpar}
\end{definition}

\begin{theorem}[Abhängige Funktionsextensionalität]
  Seien $A:\mU$ und $B:A\to\mU$. Dann gilt für abhängige Funktionen $f,g:\prod_{x:A}B(x)$:
  \begin{enumerate}
  \item Es gibt eine Funktion $\varphi:f\sim g \to f = g$ und es gilt $\mathrm{hap}(\varphi(H))=H$ für jede abhängige Homotopie $H:f\sim g$.
  \item Die Funktion
    \begin{mathpar}
      \mathrm{hap} :f=g\to f\sim g
    \end{mathpar}
    ist eine Äquivalenz.
  \end{enumerate}
\end{theorem}
\begin{beweis}
  \begin{enumerate}
  \item   Zunächst konstruieren wir für $H:\prod_{x:A}f(x)=g(x)$ eine Gleichheit $p_H:f=g$.
  Für $x:A$ können wir die Gleichheit $f(x)=g(x)$ durch eine Abbildung $I\to B(x)$ ersetzen
  und damit $H$ durch die Abbildung
  \begin{mathpar}
    \tilde{H}\colonequiv (x:A)\mapsto \rec{I}(B(x),f(x),g(x),H_x) : \prod_{x:A}I\to B(x)
  \end{mathpar}
  Nun vertauschen wir $A$ und $I$:
  \begin{mathpar}
    \tilde{\tilde{H}}\colonequiv (i:I)\mapsto (x:A)\mapsto \tilde{H}(x)(i) : I\to\prod_{x:A}B(x)
  \end{mathpar}
  Und damit haben wir $p_H\colonequiv \tilde{\tilde{H}}(s) : f=g$.

  Nun können wir durch kommutieren von $\mathrm{ap}$ und $\circ$ sehen, dass gilt:
  \begin{align*}
    \mathrm{hap}(\varphi(H))&\equiv (x:A)\mapsto\mathrm{ap}(f\mapsto f(x),\varphi(H)) \\
                            &\equiv (x:A)\mapsto\mathrm{ap}(f\mapsto f(x),\mathrm{ap}((i:I)\mapsto (y:A)\mapsto \tilde{H}(y)(i),s)) \\
                            &= (x:A)\mapsto \mathrm{ap}((i:I)\mapsto \tilde{H}(x)(i),s) \\
                            &= (x:A)\mapsto H_x
  \end{align*}
\item Nun können wir den Gleichheitssatz verwenden, wenn wir es schaffen zu zeigen, dass
  \begin{mathpar}
    \sum_{g:\prod_{x:A}B(x)}f\sim g
  \end{mathpar}
  kontrahierbar ist. Dazu berechnen wir erstmal mit Gleichheitsinduktion über $p:g=g'$,
  dass für den entsprechenden Transport und eine Homotopie $H:f\sim g$ gilt:
  \begin{mathpar}
    \transp_{g\mapsto f\sim g}(p)(H)=(x:A)\mapsto H_x\kon \mathrm{hap}(p)_x
  \end{mathpar}
  Sei $(f,x\mapsto \refl_{f(x)})$ unser Kontraktionszentrum.
  Dann ist für jedes weitere $(g,H):\sum_{g:\prod_{x:A}B(x)}f\sim g$ durch die Konstruktion am Anfang des Beweises eine Gleichheit $p_H:f=g$ gegeben.
  Um zu zeigen, dass $(f,x\mapsto \refl_{f(x)})=(g,H)$ gilt, müssen wir nach der Charakterisierung in \cref{lem:gleichheit-summe} also nur noch zeigen:
  \begin{mathpar}
    \transp_{g\mapsto f\sim g}(p_H)(x\mapsto\refl_{f(x)})=H
  \end{mathpar}
  Linke und rechte Seite dieser Gleichung sind abhängige Funktionen des Typs $\prod_{x:A}f(x)=g(x)$,
  also können wir die Konstruktion ``$p_H$'' anwenden, um die benötigte Gleichheit aus einer Punktweisen Gleichheit, also aus 
  \begin{mathpar}
    \transp_{g\mapsto f\sim g}(p_H)(x\mapsto\refl_{f(x)})\sim H
  \end{mathpar}
  zu folgern. Diese gilt aber bereits nach der Berechnung des Transports und (a).
\end{enumerate}
\end{beweis}

Nachdem wir nun die vermutlich einfachsten nicht-trivialen höheren induktiven Typen (HIT) kennen gelernt haben,
wollen wir uns zum Abschluss des Abschnitts noch einem etwas komplizierteren HIT widmen,
dem sogenannten Mengenquotient.

\begin{regeln}
  Seien $A:\mU$ und $R:A\to A\to \mU$. Dann ist $A / R:\mU$ der höhere induktive Typ mit den folgenden Konstruktoren:
  \begin{align*}
    [\_]&:A\to A / R \\
    \mathrm{eq /}&:\prod_{x,y:A}R(x,y)\to [x] =_{A / R} [y] \\
    \mathrm{set /}&:\prod_{x,y:A / R}\prod_{p,q : x=y}p=q
  \end{align*}
  Der Typ $A / R$ heißt \begriff{Mengenquotient}.
\end{regeln}

\begin{bemerkung}
  $A / R$ ist stets eine Menge. Und es gibt folgendes Rekursionsprinzip:
  Für jede Menge $B$, Funktion $f:A\to B$ und Nachweis, dass die Relation respektiert wird,
  also einen Term in
  \begin{mathpar}
    r:\prod_{x,y:A}R(x,y)\to f(x)=_B f(y)
  \end{mathpar}
  gibt es eine Funktion
  \begin{mathpar}
    \rec{A / R}(B,f,r) : A / R \to B
  \end{mathpar}
  Analog gibt es ein vereinfachtes Induktionsprinzip.
  Für jede Aussage $P:A / R \to \mU$ (also $P(x)$ Aussage für jedes $x:A / R$) reicht es $P([a])$ für alle $a:A$ zu zeigen, um $\prod_{x:A / R}P(x)$ zu zeigen.
\end{bemerkung}
\begin{beweis}
  Auf die Fälle für die höheren Konstruktoren kann jeweils verzichtet werden, da die entpsrechenden Gleichheiten in Mengen bzw. Aussagen stets existieren.
\end{beweis}

Wir werden nun die Konstruktion von $\Z$ als Quotient der Menge der Paare in $\N\times \N$ mithilfe von Mengenquotienten nachbauen.
Die Paare $(n,k):\N\times\N$ darf man sich als Differenz ``$n-k$'' vorstellen, was auch die folgende Relation erklärt.

\begin{definition}
  Sei für $(n,k),(n',k'):\N\times\N$:
  \begin{mathpar}
    (n,k) \sim_\Z (n',k')\colonequiv n+k'=_\N n'+k
  \end{mathpar}
  Die \begriff{Ganzen Zahlen}\index{$\Z$} sind wie folgt als Mengenquotient gegeben:
  \begin{mathpar}
    \Z\colonequiv \N\times\N / {\sim_\Z}
  \end{mathpar}
\end{definition}

\begin{definition}
  Die Funktion $\mathrm{succ}_\Z:\Z \to \Z$ sei durch Rekursion gegeben durch:
  \begin{mathpar}
    s(n,k)\colonequiv (\sucN(n),k) 
  \end{mathpar}
  und den Nachweis der Wohldefiniertheit:
  Sei $(n,k)\sim_\Z (n',k')$, dann gilt $n+k'=n'+k$, also auch $\sucN(n+k')=\sucN(n'+k)$.
  Letzteres ist nach der Definition der Addition $\sucN(n)+k'=\sucN(n')+k$, also gilt $s(n,k)\sim_\Z s(n',k')$.
\end{definition}

\subsection{n-Typen}
In \cref{def:kontr-aussage-menge} hatten wir bereits kontrahierbare Typen, Aussagen und Mengen definiert.
Die Mengen haben den alternativen Namen $0$-Typen und zu Aussagen, kann man auch $-1$-Typen und zu kontrahierbaren Typen $-2$-Typen sagen.
Wir werden in diesem Abschnitt $n$-Typen definieren, für $n=-2,-1,0,1,\dots$.
Dazu sei zunächst:
\begin{definition}
  Es sei $\N_{-2}$ der induktive Typ mit Konstruktoren $-2:\N_{-2}$ und $\sucHL:\N_{-2}\to\N_{-2}$.
  Für $\sucHL(n)$ schreiben wir $n+1$.
  Die Elemente von $\N_{-2}$ nennen wir auch \begriff{Abschneidungslevel}.
\end{definition}
Damit können wir $n$-Typen für jeden Abschneidungslevel $n$ definieren:
\begin{definition}
  \begin{enumerate}
  \item Für jeden Typ $A$ sei der Typ $\isNType{n}$ wie folgt per Rekursion über $n:\N_{-2}$ definiert:
    \begin{align*}
      \isNType{(-2)}(A)&\colonequiv \isContr(A) \\
      \isNType{(n+1)}(A)&\colonequiv \prod_{x,y:A}\isNType{n}(x=_A y)
    \end{align*}
  \item Der \begriff{Typ der $n$-Typen} ist für $n:\N_{-2}$:
    \begin{mathpar}
      n\mathrm{-Type}\colonequiv \sum_{A:\mU} \isNType{n}(A)
    \end{mathpar}
    Diesen Typ gibt es also für jeden Universenlevel.
  \end{enumerate}
\end{definition}

\begin{lemma}
  Sind Typen $A,B:\mU$ äquivalent und ist $A$ ein $n$-Typ, dann ist auch $B$ ein $n$-Typ.
\end{lemma}
\begin{beweis}
  Univalenz.
\end{beweis}

\begin{lemma}
  \label{lem:pi-n-type}
  Sei $A:\mU$ und $B:A\to\mU$ so, dass $B(x)$ für jedes $x:A$ ein $n$-Typ ist.
  Dann ist $\prod_{x:A}B(x)$ ein $n$-Typ.
\end{lemma}
\begin{beweis}
  Wir beweisen zunächst den Fall $n\equiv -2$. Seien also die $B(x)$ kontrahierbar.
  Dann gibt es eine abhängige Funktion $z:\prod_{x:A}B(x)$, die jedes $x:A$ auf das Kontraktionszentrum von $B(x)$ abbildet.
  Es reicht also zu zeigen, dass $\prod_{x:A}B(x)$ eine Aussage ist.
  Seien dazu $f,g:\prod_{x:A}B(x)$. Wir wollen $f=g$ zeigen.
  Mit abhängiger Funktionsextensionalität reicht es zu zeigen, dass $f\sim g$ gilt.
  Wir wissen aber, dass für jedes $x:A$ bereits $f(x)=g(x)$ gilt, da $B(x)$ eine Aussage ist.

  Wir zeigen nun die eigentliche Aussage per Induktion über den Abschneidungslevel.
  Seien nun also die $B(x)$ $n+1$-Typen.
  Für $f,g:\prod_{x:A}B(x)$ gilt $f=g \simeq f\sim g \equiv \prod_{x:A}f(x)=_{B(x)}g(x)$.
  Letzteres ist ein Gleichheitstyp in einem $n+1$-Typ, also ein $n$-Typ.
  Damit können wir die Induktionshypothese anwenden und sehen, dass auch $f=g$ ein $n$-Typ sein muss und damit dass $\prod_{x:A}B(x)$ ein $n+1$-Typ ist.
\end{beweis}

\begin{lemma}
  \label{lem:isprop-hlevel}
  Sei $A:\mU$. Für jedes $n:\N_{-2}$ gilt $\isProp(\isNType{n}(A))$.
\end{lemma}
\begin{beweis}
  Induktion über den Abschneidungslevel.
  Wir zeigen also zunächst: $\isProp(\isContr(A))$.
  Seien also
  \begin{mathpar}
    (a,H),(a',H'):\isContr(A)\equiv\sum_{x:A}\prod_{y:A}x=y
  \end{mathpar}
  Mit \cref{lem:gleichheit-summe} müssen wir also zeigen:
  \begin{mathpar}
    \sum_{p:a=a'}\transp_{x\mapsto \prod_{y:A}x=y}(p)(H)=H'
  \end{mathpar}
  wobei der Transport die Linkskonkatenation mit $p^{-1}$ ist.
  Wir wählen $p\colonequiv H_{a'}$. Dann ist noch zu zeigen:
  \begin{mathpar}
    \prod_{y:A}H_{a'}^{-1}\kon H_y=H'_y
  \end{mathpar}
  Das lässt sich etwas überraschend auf dem Umweg über die Verallgemeinerung
  \begin{mathpar}
    \prod_{q:x=y}H_{x}^{-1}\kon H_y=q
  \end{mathpar}
  mit Gleichheitsinduktion zeigen. Damit ist also $\isContr(A)$ eine Aussage.

  Jetzt nehmen wir also an, dass $\isNType{n}(A)$ eine Aussage ist und zeigen, dass $\isNType{(n+1)}(A)$ eine Aussage ist.
  Nach Definition gilt
  \begin{mathpar}
    \isNType{(n+1)}(A)\equiv \prod_{x,y:A}\isNType{n}(x=_A y)
  \end{mathpar}
  Für festes $x:A$ ist also mit \cref{lem:pi-n-type} der Typ $\prod_{y:A}\isNType{n}(x=_A y)$ eine Aussage.
  Mit erneutem Anwenden von \cref{lem:pi-n-type}, ist also auch $\prod_{x:A}\prod_{y:A}\isNType{n}(x=_A y)$ eine Aussage.
\end{beweis}


Damit können wir sofort einsehen:

\begin{korollar}
  Seien $A,B:\mU$ und $f:A\to B$.
  Die folgende Definition von $\isEquiv(f)$ ist eine Aussage:
  \begin{mathpar}
    \prod_{y:B}\isContr(f^{-1}(y))
  \end{mathpar}
\end{korollar}

\begin{beweis}
  Zunächst wissen wir durch \cref{lem:isprop-hlevel}, dass $\isContr(f^{-1}(y))$ für jedes $y:B$ eine Aussage ist.
  Mit \cref{lem:pi-n-type} wissen wir außerdem, dass das abhängige Produkt über Aussagen wieder eine Aussage ist.
\end{beweis}

Wir haben in \cref{lem:pi-n-type} bereits gesehen, dass die Gesamtheit der $n$-Typen für festes $n$ unter abhängigen Produkten abgeschlossen ist.
Nun werden wir sehen, dass Ähnliches für den Großteil der Konstruktionen gilt, die wir soweit kennen.

\begin{bemerkung}
  \label{bem:n-type-cumulative}
  \begin{enumerate}
  \item Jeder $n$-Typ ist auch ein $(n+1)$-Typ.
  \item Wenn $A$ ein $n$-Typ ist, dann sind auch alle Gleichheitstypen $x=_A y$ für $x,y:A$ wieder $n$-Typen.
  \end{enumerate}
\end{bemerkung}
\begin{beweis}
  \begin{enumerate}
  \item Sei zunächst $n\equiv -2$, also $A$ kontrahierbar mit Zeugen $(z,H):\isContr(A)$.
    Für $x,y:A$ wählen wir $H^{-1}_x\kon H_y: x=_A y$ als Kontraktionszentrum.
    Per Gleichheitsinduktion gibt es für beliebiges $p:x=y$ eine Gleichheit $H_x^{-1}\kon H_y=p$.

    Für den Induktionsschritt sei nun $A$ ein $(n+1)$-Typ.
    Damit sind alle $x=_A y$ $n$-Typen. Nach Induktionshypothese ist $x=y$ also auch ein $(n+1)$-Typ und damit $A$ ein $(n+2)$-Typ.
  \item Für $n\equiv -2$ haben wir das bereits in (a) nachgerechnet.
    Nach Definition ist für einen $n+1$-Typ $A$ jeder Gleichheitstyp ein $n$-Typ, also nach (a) auch ein $n+1$-Typ.
  \end{enumerate}
\end{beweis}

Wenn man bedenkt, dass es für jeden Typ $A$ eine Äquivalenz $A\simeq \sum_{x:A}\eins$ gibt, wird klar, dass für abhängige Summen
kein direktes Analogon zu \cref{lem:pi-n-type} gelten kann. Weiter wäre das seltsam, weil der Spezialfall von Produkten symmetrisch ist.
Es liegt also Nahe, für abhängige Summen auch Bedingungen an die Basis zu stellen, um den Abschneidungslevel zu erhalten:

\begin{lemma}
  \label{lem:sum-n-type}
  Seien $A:\mU$ und $B:A\to\mU$. Wenn $A$ ein $n$-Typ und $B(x)$ für jedes $x:A$ ein $n$-Typ ist, dann ist auch die abhängige Summe $\sum_{x:A}B(x)$ ein $n$-Typ.
\end{lemma}
\begin{beweis}
  Sei $n\equiv -2$, also $A$ kontrahierbar und für jedes $x:A$ $B(x)$ kontrahierbar.
  Wir wählen $(z,b):\sum_{x:A}B(x)$ als Kontraktionszentrum, für ein Kontraktionszentrum $z:A$ von $A$ und $b:B(z)$ von $B(z)$.
  Seien $z':A$ und $b':B(z')$. Es gilt:
  \begin{mathpar}
    (z,b)=(z',b') \simeq \sum_{p:z=z'}\transp_B(p)(b)=b'
  \end{mathpar}
  Die beiden Gleichheiten auf der rechten Seite gibt es jeweils wegen Kontrahierbarkeit.

  Seien nun $A$ und jedes $B(x)$ ein $(n+1)$-Typ. Dann ist ohne Einschränkung zu zeigen, dass für $x,y:A$ und $b:B(x)$, $b':B(y)$ der Typ
  \begin{mathpar}
    (x,b)=(y,b') \simeq \sum_{p:x=y}\transp_B(p)(b)=b'
  \end{mathpar}
  ein $n$-Typ ist. Die rechte Seite ist aber eine abhängige Summe von $n$-Typen, also nach Induktionshypothese ein $n$-Typ.
\end{beweis}

\begin{bemerkung}
  Sei $n\geq 0$. Koprodukte von $n$-Typen sind $n$-Typen.
\end{bemerkung}
\begin{beweis}
  Seien $A,B:\mU$ und $(n+1)\geq -1$ ein Abschneidungslevel.
  Wir zeigen, dass $A\amalg B$ ein $(n+1)$-Typ ist, indem wir zeigen, dass alle Gleichheitstypen von $A\amalg B$ $n$-Typen sind.
  Nach Übungsaufgabe 3 von Blatt 7, ist der Gleichheitsyp des Koprodukts $A\amalg B$ faserweise äquivalent zu:
  \begin{align*}
    \Eq{\amalg}(\iota_1(a),\iota_1(a'))&\colonequiv (a=_A a') \\
    \Eq{\amalg}(\iota_1(a),\iota_2(b))&\colonequiv \leer \\
    \Eq{\amalg}(\iota_2(b),\iota_1(a))&\colonequiv \leer \\
    \Eq{\amalg}(\iota_2(b),\iota_2(b'))&\colonequiv (b=_B b')
  \end{align*}
  Der Typ $\leer$ ist eine Aussage. Da $n\geq -1$ ist, ist also $\leer$ mit \Cref{bem:n-type-cumulative} auch ein $n$-Typ.
  Die Typen $a=a'$ und $b=b'$ sind auch jeweils $n$-Typen, also sind alle Gleichheitstypen von $A\amalg B$ $n$-Typen.
\end{beweis}

\begin{bemerkung}
  \begin{enumerate}
  \item Seien $A,B:\mU$ und $f:A\to B$. Die Fasern von $\mathrm{ap}(f,\_):x=y\to f(x)=f(y)$ sind genau dann $n$-Typen, wenn jede Faser von $f$ ein $(n+1)$-Typ ist.
  \item Untertypen von $n$-Typen sind $n$-Typen.
  \end{enumerate}
\end{bemerkung}
\begin{beweis}
  \begin{enumerate}
  \item Die Aussage folgt, wenn die Gleichheitstypen jeder Faser von $f$ äquivalent zu Fasern von $\mathrm{ap}(f,\_)$ sind und umgekehrt.
    Seien also $y:B$ und $(x,p),(x',p'):f^{-1}(y)$, dann gilt:
    \begin{align*}
      (x,p)=(x',p') &\simeq \sum_{q:x=x'}\transp_{f(\_)=y}(q)(p)=p' \\
                    &\simeq \sum_{q:x=x'}f(q)^{-1}\kon p=p' \\
                    &\simeq \sum_{q:x=x'}f(q)=p'^{-1}\kon p \\
                    &\simeq \mathrm{ap}(f,\_)^{-1}(p'^{-1}\kon p)
    \end{align*}
    Und für $p:f(x)=f(y)$ gilt:
    \begin{align*}
      \mathrm{ap}(f,\_)^{-1}(p) &\sum_{q:x=y}f(q)=p \\
      &\simeq \sum_{q:y=x}f(q)^{-1}\kon p=\refl_{f(x)}\\
                                &\simeq ((y,p)=_{f^{-1}(f(x))}(x,\refl_{f(x)}))
    \end{align*}
  \item Das folgt aus (a) für $n\equiv -1$ und Übungsaufgabe 4 von Blatt 9.
  \end{enumerate}
\end{beweis}

Es ist nicht der Fall, dass das Universum der $n$-Typen, also der Typ
\begin{mathpar}
  n\hbox{-}\mathrm{Type}\equiv\sum_{A:\mU}\isNType{n}(A)
\end{mathpar}
wieder ein $n$-Typ ist. Ein Gegenbeispiel ist durch $(\zwei=\zwei)\simeq \zwei$ gegeben: $\zwei$ ist ein $0$-Typ, aber es gibt zwei verschiedene Gleichheiten zwischen $\zwei$ und $\zwei$ im Typ $\nType{0}$.
Letzterer könnte also bestenfalls noch ein $1$-Typ sein. Das ist tatsächlich so:

\begin{bemerkung}
  \label{bem:level-of-n-typ}
  Der Typ der $n$-Typen ist ein $(n+1)$-Typ.
\end{bemerkung}
\begin{beweis}
  Für $n\equiv -2$, sind alle Typen äquivalent zu $\eins$ und $(\eins=\eins) \simeq \eins$ ist ein (-2)-Typ, also auch ein (-1)-Typ.
  
  Seien nun $A,B:\mU$ zwei (n+1)-Typen. Wir wollen zeigen, dass im Typ der (n+1)-Typen also für Paare $(A,X),(B,Y):\nType{(n+1)}$ gilt, dass $(A,X)=(B,Y)$ ein $n$-Typ ist.
  Da $X,Y$ nur Elemente von Aussagen sind gilt:
  \begin{mathpar}
    \left((A,X)=_{\nType{(n+1)}}(B,Y) \right)\simeq \left(A=_\mU B\right) \simeq (A\simeq B)
  \end{mathpar}
  Letzteres ist ein Untertyp von $A\to B$, was nach \cref{lem:pi-n-type} ein $n$-Typ ist.
\end{beweis}

\subsection{Überlagerungen I}

Bevor wir uns dem eigentlichen Thema zuwenden, brauchen wir noch eine Variante der ganzen Zahlen mit einem Rekursionsprinzip,
das uns auch Abbildungen in nicht notwendigerweise 0-abgeschnittene Typen erlaubt.

\begin{regeln}
  Zunächst sei $\N_1:\mU$\index{$\N_1$} der induktive Typ mit Konstruktoren $1_{\N_1}:\N_1$ und $\mathrm{succ}_{\N_1}:\N_1\to\N_1$.
  Nun sei $\Z':\mU$ der induktive Typ mit Konstruktoren:
  \begin{align*}
    0_{\Z'}&:\Z' \\
    \mathrm{pos}&:\N_1\to\Z' \\
    \mathrm{neg}&:\N_1\to\Z'
  \end{align*}
  Wir nennen den Typ $\Z'$ die \begriff{(induktiven) ganzen Zahlen}\index{$\Z'$}\index{$\Z$} und werden auch später auf den Strich verzichten und einfach $\Z$ schreiben.
  Als Induktionsprinzip ergibt sich also, dass wir Konstruktionen für die positiven Zahlen, die negativen Zahlen und die 0 ausführen müssen.
\end{regeln}

\begin{bemerkung}
  Die Typen $\N_1$ und $\Z'$ sind Mengen.
\end{bemerkung}
\begin{beweis}
  Nach \cref{thm:gleichheit-nat} ist der Typ $\N$ eine Menge und dieser ist äquivalent zu $\N_1$.
  Für $\Z'$ führen wir einen Beweis mit der üblichen Methode. Sei dazu $\mathrm{Eq}_{\Z'}:\Z'\to\Z'\to\mU$ gegeben durch:
  \begin{align*}
    \mathrm{Eq}_{\Z'}(0_{\Z'},0_{\Z'})&\colonequiv \eins \\
    \mathrm{Eq}_{\Z'}(\mathrm{pos}(n),\mathrm{pos}(k))&\colonequiv n=_{\N_1}k \\
    \mathrm{Eq}_{\Z'}(\mathrm{neg}(n),\mathrm{neg}(k))&\colonequiv n=_{\N_1}k \\
    \text{übrige Fälle }&\colonequiv \leer
  \end{align*}
  Den Reflexivitätsterm $r_{\Z'}:\prod_{x:\Z'}\mathrm{Eq}_{\Z'}(x,x)$ können wir definieren als $\ast$, im Fall $x\equiv 0$ und als $\refl_{n}$ in den Fällen $x\equiv \mathrm{pos}(n)$ und $x\equiv \mathrm{neg}(n)$.
  Nun ist etwa für $x\equiv \mathrm{pos}(n)$ zu zeigen, dass
  \begin{mathpar}
    \sum_{x:\Z'}\mathrm{Eq}_{\Z'}(\mathrm{pos}(n),x)
  \end{mathpar}
  kontrahierbar ist. Per Induktion über $x$ ist das nur noch für $x\equiv \mathrm{pos}(k)$ zu zeigen, da in allen anderen Fällen nur etwas für alle Elemente des leeren Typs zu zeigen ist.
  Im Fall $x\equiv \mathrm{pos}(k)$ müssen wir allerdings nur zeigen, dass ein Element $(k,p):\sum_{k:\N_1}n=k$ gleich $(n,\refl)$ ist - das können wir mit \cref{lem:pfade-kontrahierbar} zeigen.
\end{beweis}

\begin{bemerkung}
  Es gilt $\Z\simeq \Z'$. Wir schreiben daher ab jetzt $\Z$ für beide.
\end{bemerkung}
\begin{beweis}
  Übungsaufgabe.
\end{beweis}

Nun können wir uns den Überlagerungen zuwenden. Speziell werden wir mit der universellen Überlagerung des Kreises beginnen.
In der Topologie wird diese als Kopie der reellen Gerade $\R$ konstruiert, die als Helix über dem topologischen Kreis $\mathbb{S}^1=\{(x,y)\in\R^2\vert x^2+y^2=1\}$ liegt.
Als konkrete Projektion von $\R$ auf $\mathbb{S}^1$ kann etwa
\begin{mathpar}
  (t:\R) \mapsto (\cos(2\pi t),\sin(2\pi t))
\end{mathpar}
gewählt werden. Unser folgender abstrakter Nachbau dieser Situation handelt zwar nur von den Homotopietypen der beteiligten topologischen Räume, ist aber trotzdem überraschend ähnlich.
So werden etwa die Fasern der abstrakten Projektion ebenfalls $\Z$ sein.
Tatsächlich werden wir sogar genau damit beginnen.

Unser Ziel wird zunächst sein, zu beweisen, dass der Gleichheitstyp $\ast=_{S^1}\ast$ äquivalent zu $\Z$ ist.
Dazu geben wir diesen spezielleren Gleichheitstypen noch ihren üblichen Namen.

\begin{definition}
  \begin{enumerate}
  \item Ein \begriff{punktierter Typ} ist ein Paar $(A,a):\sum_{A:\mU}A$. Wir werden oft von punktierten Typen $A:\mU$ sprechen und implizit den Punkt mit $\ast:A$ bezeichnen.
  \item Der \begriff{Schleifenraum}\index{$\Omega$} eines punktierten Typs $(A,\ast)$ ist der Typ $\Omega(A,\ast)\colonequiv (\ast=_A\ast)$.
  \end{enumerate}
\end{definition}

\begin{definition}
  Die \begriff{universelle Überlagerung} von $S^1$ ist der abhängige Typ $\tilde{S^1}:S^1\to\mU$ gegeben durch
  \begin{mathpar}
    \tilde{S^1}\colonequiv \rec{S^1}(\mU, \Z, \ua({\mathrm{succ}}_\Z))
  \end{mathpar}
  Es gilt also $\tilde{S^1}(\ast)=\Z$ und $\mathrm{ap}(\tilde{S^1},l)=\ua(\mathrm{succ}_{\Z})$.
\end{definition}

Die letztere Gleichheit lässt sich etwas greifbarer machen und entspricht im topologischen Fall der Monodromieaktion eines Erzeugers der Fundamentalgruppe.


\begin{bemerkung}
  Es gilt $\transp_{\tilde{S^1}}(l)=_{\Z\to\Z}\mathrm{succ}_\Z$.
\end{bemerkung}
\begin{beweis}
  Allgemein gilt für einen abhängigen Typ $B:A\to\mU$:
  \begin{mathpar}
    \prod_{x,y:A}\prod_{p:x=y}\ua(\transp_B(p))=\mathrm{ap}(B,p)
  \end{mathpar}
  was sich per Induktion über $p$ beweisen lässt, da $\ua(\id_{B(x)})=\refl_{B(x)}$ gilt.
  Damit gilt also
  \begin{mathpar}
    \ua(\transp_{\tilde{S^1}}(l))=\mathrm{ap}(\tilde{S^1},l)=\ua(\mathrm{succ}_{\Z})
  \end{mathpar}
  womit die Behauptung folgt, weil $\ua$ eine Äquivalenz ist.
\end{beweis}

Das bedeutet, dass wir den Transport in $\tilde{S^1}$ benutzen können, um Gleichheiten der Form $\ast=_{S^1}\ast$, also Elemente des Schleifenraums $\Omega(S^1,\ast)$, mit $l$ zu vergleichen.
Da $l$ einmal den Kreis durchläuft, kann man mit der folgenden Definition messen, wie oft eine Gleichheit in $\Omega(S^1,\ast)$ den Kreis $S^1$ durchläuft.

\begin{definition}
  Die \begriff{Windungszahl} einer Gleichheit in $\Omega(S^1,\ast)$ ist der Wert unter der Abbildung
  \begin{align*}
    w&:\Omega(S^1,\ast)\to \Z \\
    w(p)&\colonequiv \transp_{\tilde{S^1}}(p)(0)
  \end{align*}
\end{definition}

Die Windungszahl wird sich später als Äquivalenz herausstellen und hat die Eigenschaften eines Gruppenhomomorphismus.
Wir zeigen das zunächst nur für Addition mit 1.

\begin{bemerkung}
  \label{bem:hom-windungszahl}
  Für alle $p:\Omega(S^1,\ast)$ gilt $w(p\kon l)=\mathrm{succ}_{\Z}(w(p))$.
\end{bemerkung}
\begin{beweis}
  Das ist durch die Verträglichkeit von Konkatenation und Komposition von Transporten gegeben:
  \begin{align*}
    w(p\kon l)&=\transp_{\tilde{S^1}}(p\kon l)(0) \\
              &=(\transp_{\tilde{S^1}}(l)\circ\transp_{\tilde{S^1}}(p))(0) \\
              &=\mathrm{succ}_\Z(\transp_{\tilde{S^1}}(p)(0)) \\
    &=\mathrm{succ}_\Z(w(p)) 
  \end{align*}
\end{beweis}

Wenn die Windungszahl eine Äquivalenz ist, bedeutet das, dass jedes $p:\Omega(S^1,\ast)$ von der Form $l^k$ für $k:\Z$ ist.
Also sollte die Inverse von $w$ durch $k$-fache Konkatenation von $l:\Omega(S^1,\ast)$ gegeben sein.

\begin{definition}
  Die \begriff{k-fache Konkatenation}\index{$\_^k$} $\_^k:\Z\to\Omega(S^1,\ast)$ ist $\Z'$- und $\N_1$-rekursiv gegeben durch
  \begin{align*}
    l^0&\colonequiv \refl_\ast \\
    l^{\mathrm{pos}(1)}&\colonequiv l \\
    l^{\mathrm{pos}(n+1)}&\colonequiv l^{\mathrm{pos}(n)}\kon l \\
    l^{\mathrm{neg}(1)}&\colonequiv l^{-1} \\
    l^{\mathrm{neg}(n+1)}&\colonequiv l^{\mathrm{neg}(n)}\kon l^{-1}
  \end{align*}
\end{definition}

Anstatt direkt zu zeigen, dass $\_^k$ und $w$ zueinander invers sind, werden wir eine faserweise Äquivalenz der Form
\begin{mathpar}
  \prod_{x:S^1}\ast=_{\tilde{S^1}}x\to \tilde{S^1}(x)
\end{mathpar}
konstruieren.

\begin{lemma}
  \label{lem:ext-windungszahl}
  Es gibt eine faserweise Abbildung 
  \begin{mathpar}
    W:\prod_{x:S^1}\ast=_{\tilde{S^1}}x\to \tilde{S^1}(x)
  \end{mathpar}
  mit:
  \begin{align*}
    W(\ast)\colonequiv w : \ast=\ast\to\Z 
  \end{align*}
\end{lemma}
\begin{beweis}
  Um einzusehen, dass $W$ durch $S^1$-Induktion definiert werden kann, müssen wir berechnen, wie die Abbildung $w$ entlang von $l:\ast=\ast$ transportiert wird.
  Dazu überlegen wir zunächst, was der Transport in einer abstrakteren Situation wäre, nämlich in einem abhängigen Typ der Form:
  \begin{mathpar}
    (x:A) \mapsto B(x)\to C(x)
  \end{mathpar}
  für zwei abhängige Typen $B:A\to\mU$ und $C:A\to\mU$. Die naheliegende Vermutung ist, dass wir mit den Transporten in $B$ und $C$ prä- und postkomponieren müssen.
  Es kann mit Induktion über $p$ geklärt werden, dass gilt:
  \begin{mathpar}
    \transp_{(x:A) \mapsto B(x)\to C(x)}(p)(f)=\transp_C(p) \circ f \circ \transp_B(p^{-1})
  \end{mathpar}
  Den Transport in $x\mapsto \ast=x$ kennen wir, das ist Rechtskonkatenation. Damit die induktive Definition von $W$ wie behauptet funktioniert,
  müssen wir also verifizieren, dass gilt:
  \begin{mathpar}
    \transp_{\tilde{S^¹}}(l) \circ w \circ \transp_{\ast=\_}(l^{-1}) = w
  \end{mathpar}
  Das lässt sich wie folgt punktweise für $p:\ast=\ast$ berechnen:
  \begin{align*}
    \transp_{\tilde{S^¹}}(l) \circ w \circ \transp_{\ast=\_}(l^{-1})(p) &= \transp_{\tilde{S^¹}}(l) \circ w(p\kon l^{-1}) \\
                                                                        &= \transp_{\tilde{S^¹}}(l) \circ \transp_{\tilde{S^1}}(p\kon l^{-1})(0) \\
                                                                        &= \transp_{\tilde{S^¹}}(l) \circ \transp_{\tilde{S^1}}(l^{-1})\circ \transp_{\tilde{S^1}}(p)(0) \\
                                                                        &=\transp_{\tilde{S^1}}(p)(0) \\
                                                                        &=w(p)
  \end{align*}
\end{beweis}

\begin{lemma}
  Es gibt auch eine Fortsetzung der Potenzfunktion $k\mapsto l^{k}:\Z\to\Omega(S^1,\ast)$, also eine faserweise Abbildung
  \begin{mathpar}
    P:\prod_{x:S^1}\tilde{S^1}(x)\to \ast=x
  \end{mathpar}
  mit $P_\ast=k\mapsto l^k$
\end{lemma}
\begin{beweis}
  Um $P$ induktiv definieren zu können, müssen wir zeigen:
  \begin{mathpar}
    \transp_{(x:S^1)\mapsto \tilde{S^1}(x)\to \ast=x}(l)(k\mapsto l^k)=(k\mapsto l^k)
  \end{mathpar}
  Analog zum beweis von \cref{lem:ext-windungszahl} ergibt sich:
  \begin{align*}
    \transp_{(x:S^1)\mapsto \tilde{S^1}(x)\to \ast=x}(l)(k\mapsto l^k) &=\transp_{\ast=\_}(l) \circ (k\mapsto l^k) \circ \transp_{\tilde{S^1}}(l^{-1}) \\
                                                                          &=(p\mapsto p\kon l) \circ (k\mapsto l^k) \circ \transp_{\tilde{S^1}}(l^{-1}) \\
                                                                          &=(k\mapsto l^{\mathrm{succ}_\Z(k)}) \circ \mathrm{succ}_\Z^{-1} \\
                                                                       &=(k\mapsto l^k)
  \end{align*}
\end{beweis}

\begin{theorem}
  Es gilt:
  \begin{enumerate}
  \item $W$ und $P$ sind faserweise zueinander invers.
  \item $w:\Omega(S^1,\ast)\to \Z$ ist eine Äquivalenz mit Inversem $k\mapsto l^{k}:\Z\to\Omega(S^1,\ast)$.
  \end{enumerate}
\end{theorem}
\begin{beweis}
  \begin{enumerate}
  \item   Wir rechnen punktweise nach. Sei $x:S^1$, dann soll für alle $p:\ast=x$ gelten:
  \begin{mathpar}
    P_x(W_x(p))=p
  \end{mathpar}
  Dank Induktion mit Basispunkt müssen wir das nur für $p\equiv \refl$ berechnen:
  \begin{mathpar}
    P_\ast(W_\ast(\refl))=P_\ast(0)=\refl
  \end{mathpar}
  Für die andere Richtung müssen wir zeigen, dass für alle $x:S^1$ und $k:\tilde{S^1}(x)$ gilt:
  \begin{mathpar}
    W_x(P_x(y))=k
  \end{mathpar}
  Das wollen wir mit Kreisinduktion zeigen. Zunächst berechnen wir also:
  \begin{mathpar}
    W_\ast(P_\ast(k))=W_\ast(l^{k})
  \end{mathpar}
  Wir sind mit dem Induktionsangfang fertig, wenn $W_\ast(l^k)\equiv w(l^k)=k$ gilt. Das können wir mit $\Z'$-Induktion und $\N_1$-Induktion zeigen:
  \begin{align*}
    w(l^0)&=\transp_{\tilde{S^1}}(\refl)(0)=0 \\
    w(l^{\mathrm{pos}(1)})&=w(l)=\mathrm{succ}_\Z(0)=\mathrm{pos}(1)  \\
    w(l^{\mathrm{pos}(n+1)})&=w(l^{\mathrm{pos}(n)}\kon l)= \mathrm{succ}_\Z(w(l^{\mathrm{pos}(n)}))=\mathrm{pos}(n+1) \\
    w(l^{\mathrm{neg}(1)})&=w(l^{-1})=\mathrm{succ}^{-1}(0)=\mathrm{neg}(1) \\
    w(l^{\mathrm{neg}(n+1)})&=w(l^{\mathrm{neg}(n)}\kon l^{-1})=\mathrm{succ}^{-1}(w(l^{\mathrm{neg}(n)}))=\mathrm{neg}(n+1)
  \end{align*}
  Nun ist noch zu zeigen, dass Transport der soeben konstruierten Gleichheit entlang $l:\ast=\ast$, wieder diese Gleichheit ist.
  Was auch immer wir genau konstruieren müssen, es ist auf jeden Fall eine Gleichheit zwischen Gleichheiten im Typ $\Z$.
  Da letzterer Typ eine Menge ist, existieren also alle Gleichheiten dieser Art.
\item In (a) für $x:S^1$ den Punkt $\ast$ einsetzen.
  \end{enumerate}
\end{beweis}

Die Eigenschaft der abhängigen Typen $\tilde{S^1}$ und $(x:S^1)\mapsto \ast=x$, dass alle Werte Mengen sind, ist bereits die definierende Eigenschaft von Überlagerungen.
Allerdings werden wir die Projektionen dieser abhängigen Typen Überlagerungen nennen.
Dabei sollte man bedenken, dass es sich hierbei nur um die Homotopietypen von Überlagerungen handelt.

\begin{definition}
  Sei $A:\mU$ ein Typ.
  \begin{enumerate}
  \item Ein abhängiger Typ $B:A\to \mU$ heißt $n$-abgeschnitten, wenn jedes $B(x)$ ein $n$-Typ, also $n$-abgeschnitten ist.
  \item Eine Abbildung heißt $n$-abgeschnitten, wenn alle ihre Fasern $n$-abgeschnitten sind.
  \item Eine Abbildung $f:A\to B$ heißt \begriff{Überlagerung}, wenn sie $0$-abgeschnitten ist.
  \end{enumerate}
\end{definition}

\subsection{Sphären, Homotopiegruppen und n-Abschneidungen}

\begin{definition}
  Seien $(A,\ast_A)$ und $(B,\ast_B)$ punktierte Typen.
  \begin{enumerate}
  \item Eine \begriff{punktierte Abbildung} oder \begriff{Abbildung punktierter Typen}\index{$\to^\ast$} ist eine Funktion $f:A\to B$ zusammen mit einer Gleichheit $p_f:f(\ast_A)=\ast_B$.
  Der Typ der punktierten Abbildungen ist:
  \begin{mathpar}
    (A,\ast_A)\to^\ast (B,\ast_B)\colonequiv  \sum_{f:A\to B}f(\ast_A)=\ast_B
  \end{mathpar}
  Wir werden auch $A\to^\ast B$ schreiben, wenn die Punktierung klar ist und etwa $(f,p_f):(A,\ast_A)\to^\ast (B,\ast_B)$, um der Gleichheit der punktierten Abbildung einen Namen zu geben.
\item Der \begriff{Typ der punktierten Typen} ist
  \begin{mathpar}
    \mU^\ast\colonequiv\sum_{A:\mU}A
  \end{mathpar}
\item Den Schleifenraum $\Omega(A,\ast_A)$ werden wir nun auch als punktierten Raum mit dem Punkt $\refl_{\ast_A}$ auffassen.
\item Für ein punktierte Abbildung $(f,p_f):(A,\ast_A)\to^\ast (B,\ast_B)$ ist
  \begin{mathpar}
    \Omega(f,p_f) \colonequiv (p:\ast_A =\ast_A) \mapsto p_f^{-1}\kon f(p) \kon p_f
  \end{mathpar}
\item Die Typen $\eins,\zwei,\N$ und $\Z$ sind jeweils durch $0$ punktiert. Alle Summen $\sum_{x:A}B(x)$ mit punktiertem $A$ und $B(\ast)$ sind punktiert und abhängige Produkte $\prod_{x:A}B(x)$ mit punktierten $B(x)$ sind punktiert.
  \end{enumerate}
\end{definition}

\begin{definition}[n-facher Schleifenraum]
  Für $n:\N$ und $(A,\ast_A)$ sei der \begriff{$n$-fache Schleifenraum} $\Omega^n(A,\ast_A)$ rekursiv gegeben durch:
  \begin{align*}
    \Omega^0&\colonequiv (A,\ast_A) \\
    \Omega^{n+1}&\colonequiv \Omega(\Omega^n(A,\ast_A))
  \end{align*}
  wobei wir Schleifenräume stets als punktiert auffassen.
\end{definition}

\begin{lemma}
  \label{lem:schleifenraum-n-typ}
  Sei $A:\mU$, dann sind für $n\geq -1$ äquivalent:
  \begin{enumerate}[label=\roman*)]
  \item $A$ ist ein $(n+1)$-Typ.
  \item Der Schleifenraum $\Omega(A,x)$ ist ein $n$-Typ für jedes $x:A$.
  \end{enumerate}
\end{lemma}
\begin{beweis}[Idee]
  Jeder Gleichheitstyp $x=_A y$ ist äquivalent zum Schleifenraum $\Omega(A,x)$, wenn es ein $p:x=_A y$ gibt.
  Tatsächlich reicht diese Aussage schon, denn für $n\geq -1$ und jedes $X$ gilt:
  \begin{mathpar}
    (X\to \isNType{n}(X))\to \isNType{n}(X)
  \end{mathpar}
\end{beweis}

\begin{definition}
  Seien $A,B,C:\mU$ und $f:A\to C$, $g:B\to C$. Es ist also ein Winkel gegeben:
  \begin{center}
    \begin{tikzcd}
      & B\arrow[d, "g"] \\
      A\arrow[r, "f", swap] & C
    \end{tikzcd}
  \end{center}
  \begin{enumerate}
  \item Sei $X:\mU$. Ein \begriff{$X$-Kegel}\index{Kegel} besteht aus Abbildungen $\varphi:X\to A$ und $\psi:X\to B$ zusammen mit einer Homotopie $H:f\circ \varphi \sim g\circ \psi$.
    Einen Kegel zusammen mit dem Winkel nennt man \begriff{Quadrat}:
    \begin{center}
      \begin{tikzcd}
        X\arrow[d,"\varphi"]\arrow[r,"\psi",swap] & B\arrow[d,"g"] \\
        A\arrow[r,"f",swap] & C 
      \end{tikzcd}
    \end{center}
      Wir schreiben $\mathrm{Cone(f,g,X)}\colonequiv\sum_{\varphi:X \to A}\sum_{\psi:X \to B}f\circ\varphi \sim g\circ\psi$ für den Typ der $X$-Kegel über dem gegebenen Winkel.
  \item Der Kegel mit Spitze
    \begin{mathpar}
      \mathrm{PB}(f,g)\colonequiv \sum_{x:A}\sum_{y:B}f(x)=g(y)
    \end{mathpar}
    und Projektionen $\pi_1:\mathrm{PB}(f,g)\to A$, $\pi_2\colonequiv \pi_1\circ \pi_2:\mathrm{PB}(f,g)\to B$ und der Homotopie $\pi_2\circ\pi_2:f\circ \pi_1 \sim g\circ \pi_2$ heißt \begriff{Pullback} von $f$ entlang $g$.
  \item Für einen $X$-Kegel $(\varphi,\psi,H)$ heißt die Abbildung
    \begin{mathpar}
      V(X,\varphi,\psi,H)\colonequiv (x:X)\mapsto (\varphi(x),\psi(x),H_x) : X \to \mathrm{PB}(f,g)
    \end{mathpar}
    \begriff{Vergleichsabbildung} und der $X$-Kegel zusammen mit dem Winkel heißt \begriff{Pullbackquadrat}, wenn $V(X,\varphi,\psi,H)$ eine Äquivalenz ist.
  \end{enumerate}
\end{definition}

\begin{bemerkung}
  Sei 
  \begin{center}
    \begin{tikzcd}
      & B\arrow[d, "g"] \\
      A\arrow[r, "f", swap] & C
    \end{tikzcd}
  \end{center}
  ein Winkel.
  \begin{enumerate}
  \item Der Pullback von $f$ und $g$ vervollständigt den Winkel zu einem Pullbackquadrat.
  \item Sei $A$ punktiert, dann ist der Schleifenraum wie folgt ein Pullback:
    \begin{center}
      \begin{tikzcd}
        \Omega(A,\ast)\ar[r]\ar[d] & \eins\ar[d, "\ast"] \\
        \eins\ar[r, "\ast", swap] & A
      \end{tikzcd}
    \end{center}
  \item Wenn $f$ punktiert ist, dann ist die Faser von $f$ wie folgt ein Pullback:
    \begin{center}
      \begin{tikzcd}
        f^{-1}(\ast)\ar[r]\ar[d] & A\ar[d, "f"] \\
        \eins\ar[r, "\ast", swap] & B
      \end{tikzcd}
    \end{center}
  \item Die Begriffe Quadrat und Pullbackquadrat sind invariant unter Ersetzen von äquivalenten Typen und homotopen Abbildungen.
  \end{enumerate}
\end{bemerkung}

\begin{lemma}
  Sei
  \begin{center}
    \begin{tikzcd}
      X\arrow[d,"\varphi"]\arrow[r,"\psi",swap] & B\arrow[d,"g"] \\
      A\arrow[r,"f",swap] & C 
    \end{tikzcd}
  \end{center}
  ein Quadrat mit Homotopie $H$, dann sind äquivalent:
  \begin{enumerate}
  \item Das Quadrat ist ein Pullbackquadrat, bzw. die Vergleichsabbildung $V(X,\varphi,\psi,H):X\to\mathrm{PB}(f,g)$ ist eine Äquivalenz.
  \item Für jedes $Y$ ist die Abbildung, die eine Funktion $\vartheta:Y\to X$ abbildet auf den $Y$-Kegel
    \begin{center}
    \begin{tikzcd}
      Y\arrow[d,"\varphi\circ \vartheta"']\arrow[r,"\psi\circ \vartheta"] & B\arrow[d,"g"] \\
      A\arrow[r,"f",swap] & C 
    \end{tikzcd}
    \end{center}
    mit Homotopie $H_\vartheta$, eine Äquivalenz.
  \item Jeder $Y$-Kegel $(\varphi',\psi',H')$ faktorisiert eindeutig über $X$. Das heißt, dass der Typ der Abbildungen $\vartheta:Y\to X$ zusammen mit Homotopien $h:\varphi\circ \vartheta\sim\varphi'$, $k:\psi\circ \vartheta\sim\psi'$ sowie $f(h)^{-1}\kon H_\vartheta\kon g(k) = H'$ kontrahierbar ist.
  \item Die induzierte faserweise Abbildung $\prod_{x:A}\varphi^{-1}(x)\to g^{-1}(f(x))$ ist eine faserweise Äquivalenz.
  \end{enumerate}
\end{lemma}

\begin{theorem}[Pullback-Pasting Teil 1]
  Seien
  \begin{center}
    \begin{tikzcd}
      Y\ar[r]\ar[d] & X\arrow[r]\arrow[d] & A\arrow[d] \\
      D\ar[r] & B\arrow[r] & C 
    \end{tikzcd}
  \end{center}
  jeweils Quadrate, es gebe also entsprechende Homotopien.
  \begin{enumerate}
  \item  Durch Komposition der Homotopien gibt es auch ein drittes Quadrat der Gestalt:
    \begin{center}
      \begin{tikzcd}
        Y\ar[rr]\ar[d] &  & A\arrow[d] \\
        D\ar[rr] &  & C 
      \end{tikzcd}
    \end{center}
  \item Wenn die beiden kleinen Quadrate Pullbacks sind, dann ist auch das dritte, zusammengesetzte ``Quadrat'' ein Pullback.
  \end{enumerate}
\end{theorem}
\begin{beweis}
  Man benutzt die Äquivalenz zu faserweisen Äquivalenzen. Dann ergibt sich die Aussage durch punktweises Anwenden von 2-aus-3 für Äquivalenzen.
\end{beweis}

\begin{theorem}[Fasersequenz]
  Sei $(f,p_f):(A,\ast)\to^\ast (B,\ast)$ eine punktierte Abbildung.
  Wir verzichten hier auf Angabe der Punktierung und verwenden die Schreibweise $-\Omega f\colonequiv p\mapsto f(p^{-1})$.
  Dann gibt es eine Sequenz:
  \begin{center}
    \begin{tikzcd}
      \Omega A \ar[r,"-\Omega f"] & \Omega B \ar[r] & f^{-1}(\ast) \ar[r,"\pi_1"] & A \ar[r,"f"] & B
    \end{tikzcd}
  \end{center}
  wobei bei aufeinanderfolgenden Abbildungen stets die linke die Faser der rechten ist - bis auf Äquivalenz.
  Weiter ist die Abbildung $\Omega B\to f^{-1}(\ast)$ gegen durch: $(\ast,p_f\kon\_)$.
\end{theorem}
\begin{beweis}
  Betrache:
  \begin{center}
    \begin{tikzcd}
      \mathrm{PB}(\ast,\pi)\ar[r]\ar[d] & \eins\ar[d,"\ast"] \\
      f^{-1}(\ast) \ar[r,"\pi"]\ar[d] & A \ar[d,"f"] \\
      \eins\ar[r,"\ast",swap] & B
    \end{tikzcd}
  \end{center}
  Durch Pullback-Pasting wissen wir, $\mathrm{PB}(\ast,\pi)$ auch Pullback des zusammengesetzen Quadrats ist.
  Aber auch $\Omega B$, oder etwas genauer $\ast=f(\ast)$ ist Pullback des zusammengesetzen Quadrats, also können wir $\mathrm{PB}(\ast,\pi)$ äquivalent ersetzen durch $\Omega B$.
  Wir müssen allerdings etwas genauer hinschauen, um zu sehen, was für eine Abbildung $\Omega B\to f^{-1}(\ast)$ wir bekommen.
  Zunächst ist der Pullback:
  \begin{mathpar}
    \mathrm{PB}(\ast,\pi_1)\equiv \left(\sum_{y:\sum_{x:A}f(x)=\ast}\pi_1(y)=\ast\right)\simeq \sum_{x:A} (f(x)=\ast)\times (x=\ast)
  \end{mathpar}
  Letzterer Typ ist nun äquivalent zu $\ast=f(\ast)$ durch: $(x,p,q)\mapsto p^{-1}\kon f(q)$, da $p^{-1}\kon f(q)$ der Wert der zusammengesetzten Homotopie im großen Quadrat ist.
  Die Projektion von $\ast=f(\ast)$ nach $f^{-1}(\ast)$ muss also $(r:\ast=f(\ast))\mapsto (\ast,r^{-1})$ sein. Die Äquivalenz zu $\ast=\ast$ bzw. $\Omega B$ ist durch die Punktierung $p_f:f(\ast)=\ast$ von $f$ gegeben.
  Die gesuchte Abbildung ist also $(p:\Omega B)\mapsto (\ast,p\kon p_f^{-1})$.
  
  Im so bestimmten Diagram nehmen wir wieder einen Pullback:
  \begin{center}
    \begin{tikzcd}
      \mathrm{PB}(\dots,\ast)\ar[r]\ar[d] & \Omega B\ar[r]\ar[d] & \eins\ar[d,"\ast"] \\
      \eins\ar[r] &f^{-1}(\ast) \ar[r,"\pi_1"]\ar[d] & A \ar[d,"f"] \\
      & \eins\ar[r,"\ast",swap] & B
    \end{tikzcd}
  \end{center}
  Genauer ist der neue Pullback: $\mathrm{PB}((\ast,p_f\kon\_),\ast)\equiv\sum_{p:\Omega B}(\ast,p_f\kon p)=(\ast,p_f)$.
  Durch waagrechtes Pullback-Pasting muss dieser Pullback allerdings äquivalent zu $\Omega A$ sein.
\end{beweis}

\begin{regeln}[Einhängung]
  Zu jedem Typ $A:\mU$ gibt es einen Typen $\Sigma A:\mU$, die \begriff{Suspension}\index{Sigma} oder \begriff{Einhängung} von $A$.
  Die Einhängung ist ein höherer induktiver Typ mit folgenden Konstruktoren:
  \begin{align*}
    N&:\Sigma A \\
    S&:\Sigma A \\
    m&:A\to N=_{\Sigma A}S
  \end{align*}
  $\Sigma A$ ist durch $N$ punktiert.
\end{regeln}

\begin{bemerkung}
  Es gilt: $(\Sigma\zwei)\simeq S^1$
\end{bemerkung}
\begin{beweis}
  Wird noch nachgetragen.
\end{beweis}

\begin{definition}
  Die (induktive) \begriff{$n$-Sphäre}\index{$S^n$} ist rekursiv gegeben durch
  \begin{align*}
    S^0&\colonequiv \zwei \\
    S^{n+1}&\colonequiv \Sigma S^n
  \end{align*}
  Da $\zwei$ punktiert ist und $\Sigma$ punktierte Typen erhält, können wir $S^n$ als punktierten Typen auffassen.
\end{definition}

\begin{regeln}
  Sei $n\geq -1$.
  Die $n$-Abschneidung eines Typen $A$ ist ein höherer induktiver Typ $\|A\|_n:\mU$ gegen durch die folgenden Konstruktoren:
  \begin{align*}
    |\_|_n&:A\to \|A\|_n \\
    \mathrm{Narbe}&:(S^{n+1}\to \|A\|_n)\to \|A\|_n \\
    \mathrm{Speiche}&:\prod_ {s:S^{n+1}\to \|A\|_n}\prod_{x:S^{n+1}} \mathrm{Narbe}(s)=s(x)
  \end{align*}
\end{regeln}

\begin{theorem}
  \label{thm:n-truncation}
  Sei $A:\mU$, dann gilt:
  \begin{enumerate}
  \item $\|A\|_n$ ist ein $n$-Typ.
  \item Für $n$-abgeschnittenes $B:\|A\|_n\to\mU$ und $s_0:\prod_{a:A}B(|a|_n)$ gibt es $s:\prod_{x:\|A\|_n}B(x)$ mit $s(|a|_n)\equiv s_0(a)$.
  \end{enumerate}
\end{theorem}

Wir werden den Beweis in mehreren Schritten führen, die auch für sich genommen interessante Aussagen sind.
Zentral für viele Dinge, ist dabei der folgende Satz:
\begin{theorem}
  \label{thm:adjunktion-schleifenraum}
  Seien $X$ und $Y$ punktierte Typen, dann gibt es eine Äquivalenz:
  \begin{mathpar}
    (\Sigma X \to^\ast Y) \simeq (X \to^\ast \Omega Y)
  \end{mathpar}
\end{theorem}
\begin{beweis}
  Die Äquivalenz lässt sich, unter anderem durch $\Sigma$-Rekursion auf die folgende Lücke ``??'' reduzieren:
  \begin{align*}
    &\Sigma X \to^\ast Y \\
    \equiv& \sum_{f:\Sigma X\to Y}f(N) = \ast \\
    \simeq & \sum_{\sum_{y_N,y_S:Y}X\to (y_N=y_S)} y_N=\ast \\
    \simeq & \sum_{y_N,y_S:Y}(X\to (y_N=y_S))\times (y_N=\ast) \\
    \simeq & \sum_{\tilde{y}:\left(\sum_{y_N:Y}y_N=\ast\right)}\sum_{y_S:Y}(X\to (\pi(\tilde{y})=y_S)) \\
    \simeq & \sum_{y_S:Y}(X\to (\ast=y_S)) \\
    ?? &  \\
    \simeq & \sum_{f:X\to \ast=_Y \ast}f(\ast)=\refl_\ast \\
    \simeq & \sum_{f:X\to \Omega Y}f(\ast)=\refl_\ast \\
    \simeq & X\to^\ast \Omega Y
  \end{align*}
  Nun schließen wir die Lücke. Seien also $y_S:Y$ und $f:X\to \ast=y_S$.
  Dann ist
  \begin{mathpar}
    \tilde{f}\colonequiv (x:X)\mapsto f(x) \kon f(\ast)^{-1} : X\to \ast=_Y \ast
  \end{mathpar}
  und es gilt $\tilde{f}(\ast)=\refl_\ast$. Wir haben also eine Abbildung gefunden.
  Sei nun $f:X\to \ast=_Y \ast$ mit $f(\ast)=\refl$. Dann ist
  \begin{mathpar}
    (\ast,f): \sum_{y_S:Y}(X\to (\ast=y_S))
  \end{mathpar}
  Um zu sehen, dass die Abbildungen invers zueinander sind, müssen wir also noch zeigen:
  \begin{mathpar}
    (y_S,f)=(\ast,\tilde{f})
  \end{mathpar}
  Dazu stellen wir fest, dass der Transport entlang $f(\ast)$ in $X\to(\ast=\_)$ punktweise Konkatenation mit $f(\ast)^{-1}$ ist.
  Wegen $\transp_{X\to(\ast=\_)}(f(\ast))(f)=\tilde{f}$ sind wir also fertig.

  Um den Beweis abzuschließen, bleibt also noch zu zeigen, dass für jedes $f:X\to\ast=\ast$ und $q:f(\ast)=\refl_\ast$ gilt:
  \begin{mathpar}
    (f,q)=(\tilde{f},\dots)
  \end{mathpar}
  wobei ``$\dots$'' eine Gleichheit ist, die durch Gruppoidrechengesetze gegeben ist.
  Zunächst können wir $q$ benutzen, um eine Homotopie zwischen $f$ und $\tilde{f}$:
  \begin{mathpar}
    \mathrm{ap}(f(x)\kon \_^{-1}, q) : f(x)\kon f(\ast)^{-1}=f(x)\kon \refl_\ast
  \end{mathpar}
  Bis auf Gruppoidrechengesetze liefert das die benötigte Homotopie.
  Mit dieser Homotopie haben wir auch eine Gleichheit $s:\tilde{f}=f$.
  Entlang dieser können wir im abhängigen Typ $g\mapsto g(\ast)=\refl_\ast$ transportieren.
  Als Transport erhalten wir:
  \begin{mathpar}
    \transp_{\_(\ast)=\refl_\ast}(s)=\mathrm{ap}(\_(\ast),s)^{-1}\kon\_
  \end{mathpar}
  Damit die Paare oben gleich sind, muss also gelten: $(\mathrm{ap}(\_(\ast),s)^{-1}\kon\_)(\dots)=q$

  Zunächst bekommen wir: $\mathrm{ap}(\_(\ast),s)=\mathrm{ap}(f(\ast)\kon\_^{-1},q)\kon\dots$, wobei wir wieder ``$\dots$'' für Gruppoidgesetze schreiben.
  Um Induktion über $q$ anwenden zu können, abstrahieren wir die Situation leicht und verwenden statt $f(\ast)$ ein beliebiges $p:\ast=\ast$.
  Dafür ergibt sich:
  \begin{mathpar}
    \dots\kon\mathrm{ap}(p\kon \_^{-1},q)\kon\dots=q^{-1}
  \end{mathpar}
  In der Situation oben berechnet sich der Wert des Transports entlang $s$ also wie gewünscht zu $q$.
\end{beweis}

Damit können wir sehen, dass Abbildungen $S^n\to A$ nichts anderes sind als iterierte Schleifen:

\begin{korollar}
  \label{kor:schleifenraum-abbildungen}
  Für punktiertes $A$ und jedes $n:\N$ gilt:
  \begin{mathpar}
    (S^n\to^\ast A)\simeq \Omega^n A
  \end{mathpar}
\end{korollar}
\begin{beweis}
  Wir beweisen per Induktion über $n$.
  Für $n\equiv 0$ müssen wir folgende Äquivalenz zeigen:
  \begin{mathpar}
    (\zwei\to^\ast A)\simeq A
  \end{mathpar}
  Da es sich um punktierte Abbildunge handelt, ist die linke Seite nichts anderes als $(\eins\to A)\simeq A$.
  Für den Induktionsschritt verwenden wir \cref{thm:adjunktion-schleifenraum}:
  \begin{align*}
    (S^{n+1}\to^\ast A)&\equiv (\Sigma S^n\to^\ast A) \\
    &\simeq (S^n\to^\ast \Omega A) \\
    &\simeq \Omega^n(\Omega A)
  \end{align*}
\end{beweis}


In \cref{lem:schleifenraum-n-typ} hatten wir gesehen, dass $n+1$-Typen genau die Typen mit $n$-Typen $\Omega(A,x)$.
Das funktioniert in eine Richtung sogar für iterierte Schleifenräume:
\begin{lemma}
  Sei $n\geq -1$. Ein Typ $A$ ist genau dann ein $n$-Typ, wenn für alle $x:A$ der Typ $\Omega^{n+1}(A,x)$ kontrahierbar ist.
\end{lemma}
\begin{beweis}
  Sei $n\equiv -1$. Dann ist zu zeigen: $A$ ist eine Aussage, wenn $A$ kontrahierbar ist. Andererseits kann mit $x:A$ gezeigt werden, dass die Aussage $A$ auch kontrahierbar ist.
  
  Für den Induktionsschritt müssen wir zeigen: $A$ ist genau dann ein $(n+1)$-Typ, wenn $\Omega^{n+2}(A,x)$ für alle $x:A$ kontrahierbar ist.
  Nach \cref{lem:schleifenraum-n-typ} reicht es zu zeigen, dass die Kontrahierbarkeit der $\Omega^{n+2}(A,x)$ äquivalent dazu ist, dass jedes $\Omega(A,x)$ ein $n+1$ Typ ist.
  Nach der Induktionshypothese ist dieser Typ genau dann ein $(n+1)$-Typ, wenn
  $\Omega^{n+1}(\Omega(A,x),p)$ für jedes $p:\Omega(A,x)$ kontrahierbar ist.

  Wir sind also fertig, wenn wir zeigen können: $\Omega^{n+1}(\Omega(A,x),p)\simeq \Omega^{n+2}(A,x)$.
  Es sollen also die Schleifen $p=p$ äquivalent sein zu den Schleifen $\refl_\ast=\refl_\ast$.
  Nun ist $\_\kon p^{-1}$ eine Äquivalenz und damit auch:
  \begin{mathpar}
    \mathrm{ap}(\_\kon p^{-1},\_):p=p\to p\kon p^{-1} = p\kon p^{-1}
  \end{mathpar}
  Letzteres ist durch Einsatz der Gruppoidgesetze äquivalent zu $\refl_\ast=\refl_\ast$.
\end{beweis}
\begin{korollar}
  \label{kor:n-abgeschnitten-kontrahierbarkeit}
  Sei $n\geq -1$. Ein Typ $A$ ist genau dann ein $n$-Typ, wenn für alle $x:A$, der Typ $(S^{n+1},\ast)\to^\ast(A,x)$ kontrahierbar ist.
\end{korollar}
\begin{beweis}
  Folgt aus dem Lemma und \cref{kor:schleifenraum-abbildungen}.
\end{beweis}

\begin{beweis}[\cref{thm:n-truncation}]
  \begin{enumerate}
  \item Per Konstruktion ist der Raum der punktierten Abbildungen $S^{n+1}\to^\ast\|A\|_n$ kontrahierbar: Als Kontraktionszentrum wählen wir die konstante Abbildung $c_\ast\colonequiv x\mapsto \ast $, die durch $\refl_\ast$ punktiert ist.
    Für eine punktierte Abbildung $(r,p_r):(S^{n+1})\to^{\ast}(\|A\|_n,\ast)$ müssen wir zunächst eine Homotopie $r\sim c_\ast$ finden.
    Für $x:S^{n+1}$ sei diese Homotopie gegeben durch
    \begin{mathpar}
      \mathrm{Speiche}(x)\kon \mathrm{Speiche}(\ast)^{-1}\kon p_r : r(x)=c_\ast(x)
    \end{mathpar}
    Für eine Gleichheit von punktierten Abbildungen müssen wir nun noch feststellen:
    \begin{mathpar}
      (\mathrm{Speiche}(\ast)\kon \mathrm{Speiche}(\ast)^{-1}\kon p_r)^{-1}\kon p_r=\refl_\ast
    \end{mathpar}
  \item Zunächst betrachten wir das Induktionsprinzip für $ \|A\|_n$. Sei also $B:\|A\|_n\to \mU$. Um $s:\prod_{x:\|A\|_n}B(x)$ induktiv zu konstruieren, brauchen wir folgende Daten:
    \begin{itemize}
    \item $s_0:\prod_{a:A}B(|a|_n)$ 
    \item Für alle $r:S^{n+1}\to \|A\|_n$ und $r':\prod_{x:S^{n+1}}B(r(x))$ ein $N_{r,r'}:B(\mathrm{Narbe(r)})$.
    \item Für alle $r:S^{n+1}\to \|A\|_n$, $r':\prod_{x:S^{n+1}}B(r(x))$ und jedes $x:S^{n+1}$ eine abhängige Gleichheit $r(x)=_{\mathrm{Speiche}(x)}^B N_{r,r'}$.
    \end{itemize}
    Die Daten für Narben und Speichen müssen wir also aus der $n$-Abgeschnittenheit von $B$ herleiten, um das gewünschte Induktionprinzip zu erhalten.
    Narbe und Speichen in $B(x)$  erhalten wir aber genau aus der $n$-Abgeschnittenheit der $B(x)$ und \cref{kor:n-abgeschnitten-kontrahierbarkeit}.
    
  \end{enumerate}
\end{beweis}

\begin{bemerkung}
  Wenn $A$ ein $n$-Typ ist, dann ist $|\_|_n:A\to \|A\|_n$ eine Äquivalenz.
\end{bemerkung}
\begin{beweis}
  Übungsblatt 12.
\end{beweis}

\begin{definition}
  \begin{enumerate}
  \item Eine \begriff{Gruppe} ist ein 0-Typ $G$ zusammen mit:
    \begin{itemize}
    \item $\_\cdot\_:G\to G\to G$
    \item $\_^{-1}:G\to G$
    \item $e:G$
    \end{itemize}
    und Gleichheiten:
    \begin{itemize}
    \item $\prod_{x,y,z:G}(x\cdot y)\cdot z=x\cdot (y\cdot z)$
    \item $\prod_{x:G}x\cdot x^{-1}=e=x^{-1}\cdot x$
    \item $\prod_{x:G}x\cdot e =x=e\cdot x$
    \end{itemize}
  \item Seien $G$ und $H$ Gruppen mit Verknüpfungen $\_\cdot_G\_$ und  $\_\cdot_H\_$. Eine Abbildung $f:G\to H$ ist ein \begriff{Gruppenhomomorphismus}, wenn es
    \begin{mathpar}
      \prod_{x,y:G}f(x\cdot_G y)=f(x)\cdot_H f(y)
    \end{mathpar}
    gibt. 
  \end{enumerate}
\end{definition}

\begin{definition}
  Sei $(A,\ast)$ punktiert und $n:\N$. Die $n$-te \begriff{Homotopiegruppe} von $A$ ist der Typ
  \begin{mathpar}
    \pi_n(A,\ast)\colonequiv \|\Omega^n(A,\ast)\|_0
  \end{mathpar}
  Für einen weiteren punktierten Typen $(B,\ast)$ und $(f,p_f):(A,\ast)\to^\ast(B,\ast)$ ist
  \begin{mathpar}
    \pi_n(f,p_f)\colonequiv \|\Omega^n(f,p_f)\|_0
  \end{mathpar}
\end{definition}

\begin{beispiel}
  Wir wissen: $\pi_1(S^1)\simeq \Z$.
\end{beispiel}

\begin{bemerkung}
  Für einen punktierten Typ $(A,\ast)$ und $n\geq 1$ ist $\pi_n(A,\ast)$ stets eine Gruppe.
  Für einen weiteren punktierten Typen $(B,\ast)$ und $(f,p_f):(A,\ast)\to^\ast(B,\ast)$ ist $\pi_n(f,p_f)$ ein Gruppenhomomorphismus.
\end{bemerkung}

\begin{definition}
  Seien $A,B$ punktiert und $f:A\to B$ eine punktierte Abbildung.
  \begin{enumerate}
  \item Das \begriff{Bild} von $f$ ist der folgende Typ:
    \begin{mathpar}
      \mathrm{im}(f)\colonequiv \sum_{b:B}\|\sum_{x:A}f(x)=b\|
    \end{mathpar}
  \item Der \begriff{Kern} von $f$ ist der folgende Typ:
    \begin{mathpar}
      \mathrm{Kern}(f)\colonequiv \sum_{x:A}f(x)=\ast
    \end{mathpar}
  \end{enumerate}
\end{definition}

\begin{theorem}
  Sei $f:A\to^{\ast}B$ eine punktierte Abbildung. Dann gibt es eine lange exakte Sequenz von punktierten $0$-Typen:
  \begin{center}
    \begin{tikzcd}
      \dots\ar[r] & \pi_{n+1}(F)\ar[r] & \pi_{n+1}(A)\ar[r,"(-1)^{n+1}\pi_{n+1}(f)"] & \pi_{n+1}(B)\ar[r] & \pi_n(F)\ar[r] & \pi_n(A)\ar[r,"(-1)^n\pi_n(f)"] & \pi_n(B)\ar[r] & \dots
    \end{tikzcd}
  \end{center}
  
\end{theorem}
\begin{beweis}
  Lassen wir hier aus. 
\end{beweis}
\begin{bemerkung}
  Man kann auch zeigen, dass es sich für $n\geq 2$ um eine lange exakte Sequenz von abelschen Gruppen handelt.
  Im Abschnitt mit $n=1$ ist es eine exakte Sequenz von Gruppen, allerdings im Allgemeinen auch mit Antihomomorphismen.
\end{bemerkung}


\subsection{Hopf-Faserung}

\begin{definition}
  Ein Typ $A$ heißt \begriff{$n$-zusammenhängend}, wenn $\|A\|_n$ kontrahierbar ist.
  Im Fall $n=0$ sagt man auch nur zusammenhängend.
\end{definition}

\begin{bemerkung}
  $S^1$ ist $0$-zusammenhängend und allgemeiner kann man zeigen: $S^{n+1}$ ist $n$-zusammenhängend.
\end{bemerkung}
\begin{beweis}
  Übungsblatt 12.
\end{beweis}

Wir werden sehen+glauben: Es gibt eine Abbildung $S^3\to S^2$ mit Faser $S^1$.
Daraus kann man mit der Fasersequenz interessante Schlüsse ziehen.

\begin{definition}
  Ein \begriff{H-Raum} ist ist ein punktierter Typ $A$ mit
  \begin{itemize}
  \item einer Operation $\mu:A\to A\to A$
  \item Homotopien $\mu(\ast,\_)\sim \id$ und $\mu(\_,\ast)\sim\id$
  \end{itemize}
\end{definition}

\begin{lemma}
  Sei $A$ ein zusammenhängender H-Raum. Dann sind die Abbildungen $\mu(x,\_)$ und $\mu(\_,x)$ für alle $x:A$ Äquivalenzen.
\end{lemma}
\begin{beweis}
  Da wir zeigen wollen, dass etwas eine Äquivalenz für alle $x:A$ ist, wollen wir ein abhängige Funktion in einem $-1$-abgeschnittenen abhängigen Typen $P:A\to\mU$ konstruieren.
  Äquivalen können wir also auch $P:A\to (-1)\hbox{-}\mathrm{Type}$ konstruieren.
  Da $(-1)\hbox{-}\mathrm{Type}$ nach \cref{bem:level-of-n-typ} ein $0$-Typ ist, faktorisiert $P$ über den kontrahierbaren Typ $\|A\|_0$,
  d.h. wir haben $P':\|A\|_0\to (-1)\hbox{-}\mathrm{Type}$ mit $P'\circ |\_|_0=P$.
  Um $P'$ zu zeigen, reicht es das etwa für $|\ast|_0$ zu machen. Aber $P'(|\ast|_0)$ ist einfach die Aussage, dass $\mu(\ast,\_)$ und $\mu(\_,\ast)$ Äquivalenzen sind und das stimmt, weil sie homotop zur Identität sind.
\end{beweis}

\begin{definition}
  Für einen zusammenhängenden H-Raum $A$ ist die \begriff{Hopf-Konstruktion} gegeben als der abhängige Typ $H:\Sigma A\to\mU$ mit:
  \begin{align*}
    H(N)&\colonequiv A \\
    H(S)&\colonequiv A \\
    H(m(a))&:= \ua(\mu(a,\_))
  \end{align*}
\end{definition}

\begin{beispiel}
  Auf $S^1$ gibt es eine Gleichheit $p:\id=\id$, gegeben durch eine Homotopie $H$ festgelegt durch $H(\ast)\colonequiv l$ und Nachrechnen des entsprechenden Transports.
  Auf $S^1$ können wir eine H-Raum-Struktur rekursiv definieren:
  \begin{align*}
    \mu(\ast,\_)&\colonequiv \id \\
    \mu(l,\_)&:=  p
  \end{align*}
  Das entspricht der komplexen Multiplikation auf $S^1$ und definiert eine H-Raum Struktur auf $S^1$.
  Der zugehörige abhängige Typ $H_{S^1}:\Sigma S^1\to\mU$ heißt \begriff{Hopf-Faserung}.
\end{beispiel}

\begin{fakt}
  Es gilt $\sum_{x:\Sigma S^1}H_{S^1}(x)\simeq S^3$.
\end{fakt}

\ignore{
Auch hinter der Einhängung steht eine allgemeinere Konstruktion, der sogenannte Pushout:

\begin{regeln}[Pushout]
  Seien $A,B,C:\mU$ und $f:C\to A$, $g:C\to B$, also folgenden Situation gegeben:
  \begin{center}
    \begin{tikzcd}
      C\ar[r,"f"]\ar[d,"g"] & A \\
      B & 
    \end{tikzcd}
  \end{center}
  Dann gibt es einen Typen $A\amalg_C B\colonequiv \mathrm{PO}(f,g):\mU$, den Pushout von $f$ und $g$, der der höhere induktive Typ mit folgenden Konstruktoren ist:
  \begin{align*}
    \iota_1&:A\to \mathrm{PO}(f,g) \\
    \iota_2&:B\to \mathrm{PO}(f,g) \\
    \mathrm{glue}&:\prod_{c:C}\iota_1(f(c))=\iota_2(g(c))
  \end{align*}
\end{regeln}

\begin{bemerkung}
  Sei $A:\mU$, dann gilt: $\Sigma A\simeq \mathrm{PO}((a:A)\mapsto \ast, (a:A)\mapsto \ast)$.
\end{bemerkung}
}

\begin{theorem}
  Es gilt:
  \begin{enumerate}
  \item $\Omega^3S^3\simeq \Omega^3S^2$
  \item $\pi_2(S^2)\simeq \Z$
  \end{enumerate}
\end{theorem}
\begin{beweis}[Ansatz]
  Das lässt sich anhand der Fasersequenz für die Hopf-Faserung $S^1\to S^3\to S^2$ erkennen.
\end{beweis}

\subsection{Eilenberg-MacLane Räume}
Das Thema dieses Abschnitts wird im HoTT-Buch nur sehr knapp erwähnt und kann im Artikel ``Eilenberg-MacLane Spaces in Homotopy Type Theory'' von Dan Licata und Eric Finster nachgelesen werden.

Zu einem punktierten Typ $A$ gibt es eine Sequenz von Gruppen, die Homotopiegruppen $\pi_n(A,\ast)$ für $n\geq 1$.
Damit liegt die Frage nahe, ob es auch für jede Sequenz von Gruppen $(G_i)_{i\geq 1}$ einen punktierten Typen $A$ mit $\pi_i(A)\simeq G_i$ gibt.
Mit der verständlichen Einschränkung, dass alle $G_i$ für $i\geq 2$ abelsch sind, lässt sich diese Frage positiv beantworten.
Wir werden hier zumindest sehen, dass es für jede Gruppe $G$ einen Typ $K(G,1)$ gibt, für den gilt:
\begin{align*}
  \pi_0(K(G,1))&\simeq \eins \\
  \pi_1(K(G,1))&\simeq G \\
  \pi_n(K(G,1))&\simeq \eins\quad\text{ für $n\geq 2$}
\end{align*}
Wir geben direkt einen höheren induktiven Typen an, der das Problem weitgehend löst:
\begin{regeln}
  Sei $G$ eine Gruppe. Dann ist $\widetilde{K(G,1)}$ der höhere induktive Typ mit Konstruktoren:
  \begin{align*}
    \ast&:\widetilde{K(G,1)} \\
    \mathrm{eq}&:\prod_{g:G}\ast=_{\widetilde{K(G,1)}}\ast \\
    \mathrm{comp}&:\prod_{g,h:G} \mathrm{eq}(g\cdot h)=\mathrm{eq}(g)\kon \mathrm{eq}(h)
  \end{align*}
\end{regeln}

\begin{definition}
  Der (erste) \begriff{Eilenberg-MacLane Raum}\index{$K(G,1)$} zu einer Gruppe $G$ ist der punktierte Typ
  \begin{mathpar}
    K(G,1)\colonequiv \|\widetilde{K(G,1)}\|_1
  \end{mathpar}
\end{definition}

\begin{bemerkung}
  $\|\ast=_{\widetilde{K(G,1)}}\ast\|_0=\Omega K(G,1)$
\end{bemerkung}
\begin{beweis}
  Ohne Beweis.
\end{beweis}

\begin{bemerkung}
  Es gibt eine Abbildung
  \begin{mathpar}
    \rho:\Omega K(G,1) \to G
  \end{mathpar}
  mit $\rho(|\mathrm{eq}(g)|_1)=g$ für alle $g:G$.
\end{bemerkung}
\begin{beweis}
  Zunächst verwenden wir, dass gilt:
  \begin{mathpar}
    \Omega \| \ast =_{K(G,1)}\ast \| _1=\|\ast=_{\widetilde{K(G,1)}}\ast\|_0
  \end{mathpar}
  Mit der universellen Eigenschaft der 0-Abschneidung, reicht es also eine Abbildung
  \begin{mathpar}
    \tilde{\rho}:\ast=_{\widetilde{K(G,1)}}\ast\to G 
  \end{mathpar}
  zu konstruieren.
\end{beweis}

\subsection{Kohomologie}
Für jede ablesche Gruppe $A$ gibt es eine Folge von punktierten, Typen
\begin{mathpar}
  A, BA, B^2A, B^3A, \dots
\end{mathpar}
sodass $\Omega^n B^nA=A$ gilt und $B^nA$ $(n-1)$-zusammenhängend ist.
\begin{definition}
  Für einen Typ $X$ und eine abelsche Gruppe $A$ ist die n-te \begriff{Kohomologiegruppe} von $X$ mit Koeffizienten in $A$ gegeben als:
  \begin{mathpar}
    H^n(X,A)\colonequiv \| X\to B^n A\|_0
  \end{mathpar}
\end{definition}
\begin{beispiel}
  Für $A\equiv \Z$ und $X\equiv S^1$ gilt: $H^1(S^1,\Z)=\Z$ (mit etwas Rechnen).
\end{beispiel}

\begin{bemerkung}
  Sei $f:X\to Y$.
  Für festes $n:\N$ ist $H^n$ funktoriell, es gibt also
  \begin{mathpar}
    f^\ast:H^n(Y,A)\to H^n(X,A)
  \end{mathpar}
  und für $g:Y\to Z$ gilt:
  \begin{mathpar}
    f^\ast \circ g^\ast = (g\circ f)^\ast
  \end{mathpar}
\end{bemerkung}


\subsection{Cubical Type Theory}
